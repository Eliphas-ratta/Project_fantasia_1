{% extends 'base.html.twig' %}

{% block title %}{{ world.name }} â€” Factions{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  {{ encore_entry_link_tags('entities') }}
{% endblock %}

{% block body %}
<div class="world-index-wrapper text-light">
  {% include 'world/_world_nav.html.twig' %}

  <div class="container text-center">
    <h1 class="mb-4 fw-bold">Factions of {{ world.name }}</h1>

    {% if userRole|lower in ['admin', 'moderator'] %}
      <a href="{{ path('app_faction_create', { id: world.id }) }}" class="btn-green mb-5">
        + Create a new Faction
      </a>
    {% endif %}

    {% if factions is empty %}
      <p class="mt-5">No factions found in this world yet.</p>
    {% else %}
      <div class="entity-grid">
        {% for faction in factions %}
          <a href="#" class="entity-link text-decoration-none text-light">
            <div class="entity-card">
              <div class="entity-image mb-3">
                <img
                  src="{{ asset(faction.image ? 'uploads/faction_images/' ~ faction.image : 'uploads/world_images/default.png') }}"
                  alt="{{ faction.name }}">
              </div>
              <h5 class="fw-bold mb-1">{{ faction.name }}</h5>
              <p class="small mb-0">
                {{ faction.description|default('No description available.') }}
              </p>
            </div>
          </a>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
