{% extends 'base.html.twig' %}

{% block title %}My Profile{% endblock %}

{% block body %}
<div class="world-wrapper">
  <div class="world-create-card text-center">

    <h2 class="title-green mb-4">{{ user.username }}'s Profile</h2>

    {% if user.profileImage %}
      <div class="mb-4">
        <img src="{{ asset('uploads/profile_images/' ~ user.profileImage) }}"
             alt="Profile Image"
             class="profile-avatar">
      </div>
    {% else %}
      <div class="mb-4">
        <img src="{{ asset('uploads/profile_images/default.png') }}"
             alt="Default Avatar"
             class="profile-avatar">
      </div>
    {% endif %}

    <div class="profile-info mb-4">
      <p><span>Email:</span> {{ user.email }}</p>
      <p><span>Account created:</span> {{ user.createAt ? user.createAt|date('Y-m-d H:i') : 'N/A' }}</p>
    </div>

    <div class="d-flex justify-content-center gap-3">
      <a href="{{ path('app_profile_edit') }}" class="btn-green px-5 py-2 fw-bold">Edit Profile</a>

      <form id="delete-form" action="{{ path('app_profile_delete') }}" method="POST">
        <input type="hidden" name="_token" value="{{ csrf_token('delete_account') }}">
        <button type="button" id="delete-btn" class="btn-danger px-4 py-2 fw-bold">Delete Account</button>
      </form>
    </div>

  </div>
</div>

<style>
/* ðŸŒŸ CohÃ©rence totale avec world.scss */
.world-wrapper {
  min-height: 80vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.world-create-card {
  width: 550px;
  background-color: #111;
  border-radius: 24px;
  padding: 3rem 2.5rem;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.6);
  transition: all 0.3s ease;
}

.title-green {
  color: #3ecf5a;
  font-weight: 800;
  text-shadow: 0 0 8px rgba(62, 207, 90, 0.4);
}

.profile-avatar {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  object-fit: cover;
  background-color: #222;
  border: 2px solid #3ecf5a;
  box-shadow: 0 0 12px rgba(62, 207, 90, 0.5);
  transition: all 0.3s ease;
}

.profile-info {
  background-color: #1a1a1a;
  border-radius: 12px;
  padding: 1.2rem;
  text-align: left;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.profile-info span {
  color: #3ecf5a;
  font-weight: 600;
}

.btn-green {
  background-color: #3ecf5a;
  color: #ffffff;
  border: none;
  font-weight: 700;
  border-radius: 10px;
  padding: 12px 26px;
  cursor: pointer;
  font-size: 1rem;
  transition: 0.25s;
  text-decoration: none;
}

.btn-green:hover {
  background-color: #34b54f;
  box-shadow: 0 0 15px rgba(62, 207, 90, 0.7);
  color: #000;
}

/* ðŸ”´ Bouton rouge suppression */
.btn-danger {
  background-color: #ff4040;
  color: #fff;
  border-radius: 10px;
  border: none;
  padding: 12px 26px;
  font-weight: 700;
  font-size: 1rem;
  transition: 0.25s;
}

.btn-danger:hover {
  background-color: #ff5555;
  box-shadow: 0 0 15px rgba(255, 64, 64, 0.6);
}
</style>

<script>
document.getElementById("delete-btn").addEventListener("click", function() {
  Swal.fire({
    title: "Are you sure?",
    text: "This will permanently delete your account.",
    icon: "warning",
    showCancelButton: true,
    confirmButtonColor: "#ff4040",
    cancelButtonColor: "#333",
    confirmButtonText: "Yes, delete it",
    background: "#1a1a1a",
    color: "#fff"
  }).then((result) => {
    if (result.isConfirmed) {
      document.getElementById("delete-form").submit();
    }
  });
});
</script>
{% endblock %}
